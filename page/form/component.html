<main class="mx-auto max-w-[var(--container)] px-[var(--gutter)] py-10">
	<div class="grid gap-4 lg:grid-cols-[1.2fr_0.8fr]">
		<!-- Left: Customer info -->
		<section
			class="flex flex-col gap-4 rounded-[var(--radius-card)] border border-[var(--c-border)] bg-[var(--c-bg-secondary)] p-5 shadow-[var(--shadow-sm)] sm:p-4"
		>
			<div
				class="flex items-center justify-between gap-3 border-b border-[var(--c-border)] pb-3"
			>
				<div class="flex flex-col gap-1">
					<h1
						class="text-[1.1rem] font-semibold text-[var(--c-text-secondary)]"
					>
						Checkout
					</h1>
					<p class="text-[0.9rem] text-[var(--c-text-primary)]">
						Enter your contact and delivery info.
					</p>
				</div>

				<wbutton
					type="link"
					[isMultipleClicksAllowed]="true"
					(wClick)="fillDemo()"
					class="!text-[0.9rem] !font-semibold"
				>
					Fill demo
				</wbutton>
			</div>

			<form
				(submit)="onSubmit(); $event.preventDefault()"
				class="flex flex-col gap-3"
			>
				<div class="grid gap-3 sm:grid-cols-2">
					<winput
						placeholder="Full name"
						[formField]="checkoutForm.fullName"
					></winput>

					<winput
						placeholder="Phone"
						type="tel"
						[formField]="checkoutForm.phone"
					></winput>
				</div>

				<winput
					placeholder="Email (optional)"
					type="email"
					[formField]="checkoutForm.email"
				></winput>

				<winput
					placeholder="Address line"
					[formField]="checkoutForm.addressLine"
				></winput>

				<div class="grid gap-3 sm:grid-cols-3">
					<winput
						placeholder="City"
						[formField]="checkoutForm.city"
					></winput>
					<winput
						placeholder="ZIP / Postal"
						[formField]="checkoutForm.zip"
					></winput>
					<winput
						placeholder="Country"
						[formField]="checkoutForm.country"
					></winput>
				</div>

				<winput
					placeholder="Notes for delivery (optional)"
					type="textarea"
					[formField]="checkoutForm.notes"
				></winput>

				<div class="flex items-center justify-between gap-3 pt-2">
					<div class="text-[0.9rem] text-[var(--c-text-muted)]">
						@if (checkoutForm().invalid()) {
						<span>Please complete required fields.</span>
						} @else {
						<span>Ready to submit.</span>
						}
					</div>

					<wbutton
						type="primary"
						[disabled]="isSubmitDisabled()"
						class="min-w-[180px]"
					>
						Place order
					</wbutton>
				</div>
			</form>
		</section>

		<!-- Right: Cart summary -->
		<aside
			class="flex h-fit flex-col gap-4 rounded-[var(--radius-card)] border border-[var(--c-border)] bg-[var(--c-bg-secondary)] p-5 shadow-[var(--shadow-sm)] sm:p-4"
		>
			<div
				class="flex items-center justify-between gap-3 border-b border-[var(--c-border)] pb-3"
			>
				<h2
					class="text-[1rem] font-semibold text-[var(--c-text-secondary)]"
				>
					Your cart
				</h2>

				<span class="text-[0.85rem] text-[var(--c-text-muted)]">
					{{ items().length }} items
				</span>
			</div>

			<div class="flex flex-col gap-3">
				@for (item of items(); track item.id) {
				<div class="flex items-start justify-between gap-3">
					<div class="flex flex-col">
						<div
							class="text-[0.95rem] font-semibold text-[var(--c-text-secondary)]"
						>
							{{ item.title }}
						</div>
						<div
							class="text-[0.85rem] text-[var(--c-text-primary)]"
						>
							Qty: {{ item.qty }}
						</div>
					</div>

					<div
						class="text-[0.95rem] font-semibold text-[var(--c-text-secondary)]"
					>
						{{ itemTotal(item) | number : '1.2-2' }}
					</div>
				</div>
				}
			</div>

			<div
				class="flex flex-col gap-2 border-t border-[var(--c-border)] pt-3"
			>
				<div
					class="flex items-center justify-between text-[0.9rem] text-[var(--c-text-primary)]"
				>
					<span>Subtotal</span>
					<span>{{ subtotal() | number : '1.2-2' }}</span>
				</div>

				<div
					class="flex items-center justify-between text-[0.9rem] text-[var(--c-text-primary)]"
				>
					<span>Delivery</span>
					<span>{{ deliveryFee() | number : '1.2-2' }}</span>
				</div>

				<div
					class="flex items-center justify-between pt-2 text-[1rem] font-semibold text-[var(--c-text-secondary)]"
				>
					<span>Total</span>
					<span>{{ total() | number : '1.2-2' }}</span>
				</div>
			</div>

			<wbutton
				type="link"
				[isMultipleClicksAllowed]="true"
				(wClick)="clearCart()"
				class="!justify-start !px-0 !text-[0.9rem]"
			>
				Clear cart
			</wbutton>
		</aside>
	</div>

	<layout-footer class="mt-6 block"></layout-footer>
</main>
